# Optimization Research
 
# HYO-IDS: Hybrid Whale-Rime Optimized Intrusion Detection System

## Overview

**HYO-IDS** is a research project aimed at developing a lightweight, real-time Intrusion Detection System (IDS) that leverages hybrid optimization techniques to efficiently select features and tune machine learning models for attack detection. The primary goal is to build a unified model that learns to distinguish between normal network traffic and various types of attacks. Although our current implementation focuses on the UNSW-NB15 dataset, the framework is designed to be extensible to other datasets (e.g., Bot-IoT 2018, CIC-DDoS2019, CICIDS2017, IoT-23, KDD Cup 1999, NSL-KDD, ToN-IoT).

### Key Components
- **Data Preprocessing:** Each dataset file (streamed individually) is cleaned, normalized, and balanced using SMOTE. For the UNSW-NB15 dataset, only the first 47 columns are used as features, while the 49th column is treated as the ground-truth label.
- **Hybrid Optimization:** A novel Whale-Rime Optimization algorithm selects an optimal subset of features from the provided 47 features, improving model efficiency and interpretability.
- **GPU-Accelerated Model Training:** The framework leverages GPU-enabled XGBoost for both candidate evaluation and Bayesian hyperparameter tuning, significantly reducing training time.
- **Model Evaluation:** The IDS model is evaluated using a variety of performance metrics, including Accuracy, Precision, Recall, F1-Score, False Positive Rate (FPR), and AUC.
- **Interpretability:** SHAP analysis is integrated to provide global and local explanations of the model’s predictions.
- **Multiple Runs & Aggregation:** The system is designed to execute multiple runs, aggregating performance metrics and recording the best fitness and optimal feature subsets for each file during each run.

## Repository Structure

```
Optimization-Research
└── Code
│   ├── HYO-IDS.py
├── shap_outputs
│       ├── shap_force.html
│       └── shap_summary.png
├── BestFitness+OptimalFeaturesSubset.txt
└── final_aggregated_report.csv
```

### File Descriptions

- **HYO-IDS.py**  
  This is the main script of the project. It implements the entire pipeline, including:
  - Reading and processing the dataset files individually (stream processing).
  - Data cleaning, normalization, and balancing (using SMOTE).
  - Hybrid feature selection using the Whale-Rime Optimization algorithm.
  - GPU-accelerated hyperparameter tuning of an XGBoost classifier via Bayesian optimization.
  - Model evaluation through various performance metrics.
  - Generating SHAP visualizations for model interpretability.
  - Aggregating performance metrics over multiple runs and appending results to the final report.
  
- **shap_outputs/shap_force.html**  
  This file contains the local force plot generated by the SHAP analysis. It provides an explanation for a single prediction (instance) made by the IDS model, showing the impact of each feature on the model’s decision.

- **shap_outputs/shap_summary.png**  
  This file contains the global summary plot from SHAP analysis. It visually represents the overall feature importance across the entire dataset, highlighting which features most influence the model's predictions.

- **BestFitness+OptimalFeaturesSubset.txt**  
  This text file logs the best fitness values and the corresponding optimal feature subsets (i.e., the indices of the selected features) for each file processed during each run of the script. It serves as a record of the feature selection performance over time.

- **final_aggregated_report.csv**  
  This CSV file aggregates performance metrics from each run of the pipeline. Each row corresponds to one run and includes metrics such as Accuracy, Precision, Recall, F1-Score, FPR, AUC, Feature Reduction Rate, and Training Time. This report helps track the consistency and overall performance of the IDS model across multiple executions.

## How to Run

1. **Setup:**  
   Ensure that all required libraries are installed. You can install them using:
   ```bash
   pip install numpy pandas matplotlib scikit-learn imbalanced-learn xgboost scikit-optimize scikit-posthocs shap scipy ipaddress
   ```
   Also, verify that you have a GPU-enabled version of XGBoost installed.

2. **Execution:**  
   Navigate to the `Code` directory and run the main script:
   ```bash
   python HYO-IDS.py
   ```
   The script will process the dataset files, perform feature selection and hyperparameter tuning, generate SHAP visualizations, and output aggregated performance metrics.

3. **Outputs:**  
   - **SHAP Visualizations:** Found in the `shap_outputs` directory.
   - **Feature Selection Logs:** Check `BestFitness+OptimalFeaturesSubset.txt` for records of the best fitness scores and selected feature subsets.
   - **Performance Report:** Review `final_aggregated_report.csv` to see the aggregated metrics for each run.

## Research Impact

HYO-IDS is designed to provide a robust, adaptable, and lightweight IDS solution suitable for real-time deployment in resource-constrained environments such as IoT devices. By integrating advanced hybrid optimization techniques with GPU acceleration, the system achieves high accuracy while maintaining efficiency and interpretability. The modular design of the framework allows for continuous updates and improvements, ensuring that the IDS remains effective against evolving attack strategies.

---

Feel free to reach out with any questions or suggestions regarding the project. Enjoy exploring and enhancing HYO-IDS!